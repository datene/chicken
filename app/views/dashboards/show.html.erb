<div class="dashboard">
  <div class="user_info">
    <div class="user_photo">
      <%= image_tag current_user.picture, class:"avatar avatar_border" %>
      <div class="user_name">
        <%= current_user.first_name%>
        <%= current_user.last_name%>
      </div>
    </div>
    <div class="user_stats">
      <div class="challenges_amount">
        <%= image_tag "flag.png", class:"dashboard_icon" %>
        <%= @challenges.count %>
      </div>
      <div class="challenges_amount">
        <%= image_tag "stopwatch.png", class:"dashboard_icon" %>
        <%= @sum_logged_times %>      
      </div>
    </div>
  </div>
  <div class="page_title">
    <h1>
      Your Challenges
    </h1>
  </div>

  <div class="challenges_index">
    <ul class="index">
      <% @challenges.each do |challenge| %>
      <div class="index-challenge-card">
        <div class="challenge-specs">
          <p><%= @opponent.first_name %></i></span></p>
        </div>
        <img class="card-user avatar avatar_shadow" src="<%= @opponent.picture %>">
        <% if challenge.winner_user?(current_user) %>
        <div class="challenge_info">
          <div class="activity_name">
            <%= challenge.activity %>
            <span><i class="fa fa-trophy"></i></span>
          </div>
          <div class="challenge_date">
            Finished
          </div>
        </div>
        <% else %>
        <div class="challenge_info">
          <div class="activity_name">
            <%= challenge.activity %>
          </div>
          <div class="challenge_date">
            From <%= challenge.start_date %> until <%= challenge.deadline %>
          </div>
        </div>
        <% end %>
        <div class="status">
          <p><%= challenge.status %></p> 
          <% if challenge.status == "pending" %>
          <%= link_to accept_challenge_path(challenge), method: :patch, data: { confirm: "Are you sure you're taking on this challenge?"} do %> 
          <i class="fa fa-check fa-2x"></i>
          <% end %>
          <%= link_to decline_challenge_path(challenge), method: :patch, data: { confirm: "Are you sure you don't want to take on this challenge?"} do %> 
          <i class="fa fa-times fa-2x"></i>
          <% end %>
          <% elsif challenge.status == "accepted" %>
          <%= link_to "Concede", concede_challenge_path(challenge), method: :patch,data: { confirm: "Are you sure you want to chicken out?"} %>
          <% else %>
          <%= link_to "Delete", challenge_path(challenge), method: :delete, data: { confirm: "Are you sure you want to delete this challenge from your list?"} %>
          <% end %>
        </div>
      </div>
      <% end %>
    </ul>
  </div>
</div>